{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    {% block meta %}{% endblock meta %}
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="{% static 'css/global.css' %}"/>
  </head>

  <!-- Tambahkan layout flex ke body -->
  <body class="flex flex-col min-h-screen">
    {% include 'navbar.html' %}

    <!-- Bungkus konten dalam flex-grow agar mengisi ruang tengah -->
    <main class="flex-grow">
      {% block content %}{% endblock content %}
    </main>

    {% include 'footer.html' %}
    
    <!-- Include logout modal for authenticated users -->
    {% if user.is_authenticated %}
      {% include 'logout_modal.html' %}
    {% endif %}
    
    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-5 right-5 z-[10000] space-y-2"></div>

     <style>
        :root {
            --dark-moss-green: #243010;
            --olive-green: #87A330;
            --android-green: #A1C349;
            --sage-green: #CAD593;
            --pine-tree-green: #2A3C24;
        }
        
        .btn-primary {
            background-color: var(--android-green);
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background-color: var(--olive-green);
            transform: translateY(-2px);
        }
        
        .card-mountain {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid var(--sage-green);
        }
    </style>

  <script>
  // Enhanced Toast System for GunDex
  window.showToast = function(message, type = "success") {
    const container = document.getElementById("toast-container");
    if (!container) return;

    const toast = document.createElement("div");
    
    // Configure toast based on type
    let bgColor, icon, borderColor;
    switch(type) {
      case 'success':
        bgColor = 'bg-green-600';
        borderColor = 'border-green-500';
        icon = '‚úÖ';
        break;
      case 'error':
        bgColor = 'bg-red-600';
        borderColor = 'border-red-500';
        icon = '‚ùå';
        break;
      case 'warning':
        bgColor = 'bg-yellow-600';
        borderColor = 'border-yellow-500';
        icon = '‚ö†Ô∏è';
        break;
      case 'info':
        bgColor = 'bg-blue-600';
        borderColor = 'border-blue-500';
        icon = '‚ÑπÔ∏è';
        break;
      default:
        bgColor = 'bg-[#87A330]';
        borderColor = 'border-[#87A330]';
        icon = 'üèîÔ∏è';
    }

    toast.className = `${bgColor} ${borderColor} text-white flex items-center gap-3 px-4 py-3 rounded-lg shadow-lg border-l-4 opacity-0 translate-x-4 transition-all duration-300 max-w-sm`;
    toast.innerHTML = `
      <span class="text-lg">${icon}</span>
      <span class="flex-1 text-sm font-medium">${message}</span>
      <button onclick="this.parentElement.remove()" class="text-white/80 hover:text-white text-lg leading-none">√ó</button>
    `;

    container.appendChild(toast);

    // Animate in
    requestAnimationFrame(() => {
      toast.classList.remove("opacity-0", "translate-x-4");
      toast.classList.add("opacity-100", "translate-x-0");
    });

    // Auto-remove after delay (longer for errors)
    const delay = type === 'error' ? 5000 : 3000;
    setTimeout(() => {
      if (toast.parentElement) {
        toast.classList.add("opacity-0", "translate-x-4");
        setTimeout(() => {
          if (toast.parentElement) {
            toast.remove();
          }
        }, 300);
      }
    }, delay);
  };

  // Mobile menu functionality
  window.toggleMobileMenu = function (e) {
    e.stopPropagation();
    const menu = document.querySelector(".mobile-menu");
    if (menu) {
      menu.classList.toggle("hidden");
    }
  };

  // Close mobile menu when clicking outside
  document.addEventListener("click", function (e) {
    const menu = document.querySelector(".mobile-menu");
    const onBtn = e.target.closest(".mobile-menu-button");
    const onMenu = e.target.closest(".mobile-menu");
    if (menu && !onBtn && !onMenu) {
      menu.classList.add("hidden");
    }
  });

  // Show Django messages as toasts on page load
  document.addEventListener('DOMContentLoaded', function() {
    {% if messages %}
      {% for message in messages %}
        let toastType = 'info';
        {% if message.tags == 'success' %}
          toastType = 'success';
        {% elif message.tags == 'error' %}
          toastType = 'error';
        {% elif message.tags == 'warning' %}
          toastType = 'warning';
        {% endif %}
        
        showToast("{{ message|escapejs }}", toastType);
      {% endfor %}
    {% endif %}
  });
  </script>

  <style>
    /* Enhanced mobile menu button styling */
    .mobile-menu-button { 
      position: relative; 
      z-index: 10000 !important; 
    }
    nav { 
      z-index: 9999 !important; 
    }
    .mobile-menu { 
      z-index: 9998 !important; 
    }
    
    /* Toast animations */
    #toast-container > div {
      backdrop-filter: blur(10px);
    }
  </style>
</body>
</html>